{"version":3,"sources":["../src/utils/errors.ts","../src/utils/retry.ts","../src/api/http.ts","../src/utils/validation.ts","../src/utils/progress.ts","../src/api/files.ts","../src/api/tasks.ts","../src/api/config.ts","../src/utils/polling.ts","../src/models/Task.ts","../src/client.ts","../src/legacy/index.ts"],"names":["path","sleep"],"mappings":"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","file":"legacy.js","sourcesContent":["/**\n * Base error class for all Conversion Tools API errors\n */\nexport class ConversionToolsError extends Error {\n  constructor(\n    message: string,\n    public readonly code: string,\n    public readonly status?: number,\n    public readonly response?: any\n  ) {\n    super(message);\n    this.name = 'ConversionToolsError';\n    Object.setPrototypeOf(this, ConversionToolsError.prototype);\n  }\n}\n\n/**\n * Authentication error - Invalid or missing API token\n */\nexport class AuthenticationError extends ConversionToolsError {\n  constructor(message = 'Not authorized - Invalid or missing API token') {\n    super(message, 'AUTHENTICATION_ERROR', 401);\n    this.name = 'AuthenticationError';\n    Object.setPrototypeOf(this, AuthenticationError.prototype);\n  }\n}\n\n/**\n * Validation error - Invalid request parameters\n */\nexport class ValidationError extends ConversionToolsError {\n  constructor(message: string, response?: any) {\n    super(message, 'VALIDATION_ERROR', 400, response);\n    this.name = 'ValidationError';\n    Object.setPrototypeOf(this, ValidationError.prototype);\n  }\n}\n\n/**\n * Rate limit error - Quota exceeded\n */\nexport class RateLimitError extends ConversionToolsError {\n  constructor(\n    message: string,\n    public readonly limits?: {\n      daily?: { limit: number; remaining: number };\n      monthly?: { limit: number; remaining: number };\n    }\n  ) {\n    super(message, 'RATE_LIMIT_EXCEEDED', 429);\n    this.name = 'RateLimitError';\n    Object.setPrototypeOf(this, RateLimitError.prototype);\n  }\n}\n\n/**\n * File not found error\n */\nexport class FileNotFoundError extends ConversionToolsError {\n  constructor(message = 'File not found', public readonly fileId?: string) {\n    super(message, 'FILE_NOT_FOUND', 404);\n    this.name = 'FileNotFoundError';\n    Object.setPrototypeOf(this, FileNotFoundError.prototype);\n  }\n}\n\n/**\n * Task not found error\n */\nexport class TaskNotFoundError extends ConversionToolsError {\n  constructor(message = 'Task not found', public readonly taskId?: string) {\n    super(message, 'TASK_NOT_FOUND', 404);\n    this.name = 'TaskNotFoundError';\n    Object.setPrototypeOf(this, TaskNotFoundError.prototype);\n  }\n}\n\n/**\n * Conversion error - Task failed during conversion\n */\nexport class ConversionError extends ConversionToolsError {\n  constructor(\n    message: string,\n    public readonly taskId?: string,\n    public readonly taskError?: string\n  ) {\n    super(message, 'CONVERSION_ERROR');\n    this.name = 'ConversionError';\n    Object.setPrototypeOf(this, ConversionError.prototype);\n  }\n}\n\n/**\n * Timeout error - Request or operation timed out\n */\nexport class TimeoutError extends ConversionToolsError {\n  constructor(message = 'Operation timed out', public readonly timeout?: number) {\n    super(message, 'TIMEOUT_ERROR', 408);\n    this.name = 'TimeoutError';\n    Object.setPrototypeOf(this, TimeoutError.prototype);\n  }\n}\n\n/**\n * Network error - Connection issues\n */\nexport class NetworkError extends ConversionToolsError {\n  constructor(message: string, public readonly originalError?: Error) {\n    super(message, 'NETWORK_ERROR');\n    this.name = 'NetworkError';\n    Object.setPrototypeOf(this, NetworkError.prototype);\n  }\n}\n","/**\n * Retry utilities with exponential backoff\n */\n\nimport { NetworkError, TimeoutError } from './errors.js';\n\nexport interface RetryOptions {\n  /** Maximum number of retry attempts */\n  retries: number;\n\n  /** Initial delay between retries in milliseconds */\n  retryDelay: number;\n\n  /** HTTP status codes that should trigger retry */\n  retryableStatuses: number[];\n\n  /** Function to determine if an error should trigger retry */\n  shouldRetry?: (error: any) => boolean;\n}\n\n/**\n * Sleep for a given duration\n */\nfunction sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n/**\n * Determine if an error should trigger a retry\n */\nfunction shouldRetryError(\n  error: any,\n  retryableStatuses: number[],\n  shouldRetry?: (error: any) => boolean\n): boolean {\n  // Custom retry logic\n  if (shouldRetry) {\n    return shouldRetry(error);\n  }\n\n  // Network errors should be retried\n  if (error instanceof NetworkError || error instanceof TimeoutError) {\n    return true;\n  }\n\n  // HTTP status code based retry\n  if (error.status && retryableStatuses.includes(error.status)) {\n    return true;\n  }\n\n  // Fetch errors (network issues)\n  if (error.name === 'FetchError' || error.code === 'ECONNRESET') {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * Execute a function with retry logic and exponential backoff\n */\nexport async function withRetry<T>(\n  fn: () => Promise<T>,\n  options: RetryOptions\n): Promise<T> {\n  const { retries, retryDelay, retryableStatuses, shouldRetry } = options;\n\n  let lastError: any;\n  let attempt = 0;\n\n  while (attempt <= retries) {\n    try {\n      return await fn();\n    } catch (error) {\n      lastError = error;\n      attempt++;\n\n      // Don't retry if max attempts reached\n      if (attempt > retries) {\n        break;\n      }\n\n      // Check if error should trigger retry\n      if (!shouldRetryError(error, retryableStatuses, shouldRetry)) {\n        throw error;\n      }\n\n      // Calculate delay with exponential backoff\n      const delay = retryDelay * Math.pow(2, attempt - 1);\n\n      // Log retry attempt (optional - could be made configurable)\n      if (process.env.DEBUG) {\n        console.debug(\n          `Retry attempt ${attempt}/${retries} after ${delay}ms. Error: ${\n            (error as Error).message || error\n          }`\n        );\n      }\n\n      // Wait before retrying\n      await sleep(delay);\n    }\n  }\n\n  // All retries exhausted\n  throw lastError;\n}\n","/**\n * HTTP client with retry logic for Conversion Tools API\n */\n\nimport type { RateLimits } from '../types/config.js';\nimport {\n  ConversionToolsError,\n  AuthenticationError,\n  ValidationError,\n  RateLimitError,\n  FileNotFoundError,\n  TaskNotFoundError,\n  NetworkError,\n  TimeoutError,\n} from '../utils/errors.js';\nimport { withRetry } from '../utils/retry.js';\n\nconst DEFAULT_BASE_URL = 'https://api.conversiontools.io/v1';\nconst DEFAULT_TIMEOUT = 300000; // 5 minutes\nconst DEFAULT_RETRIES = 3;\nconst DEFAULT_RETRY_DELAY = 1000;\nconst DEFAULT_RETRYABLE_STATUSES = [408, 500, 502, 503, 504];\n\nexport interface HttpClientConfig {\n  apiToken: string;\n  baseURL?: string;\n  timeout?: number;\n  retries?: number;\n  retryDelay?: number;\n  retryableStatuses?: number[];\n  userAgent?: string;\n}\n\nexport interface RequestOptions {\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE';\n  path: string;\n  body?: unknown;\n  headers?: Record<string, string>;\n  raw?: boolean; // Return raw response without JSON parsing\n  signal?: AbortSignal;\n}\n\nexport class HttpClient {\n  private readonly config: Required<Omit<HttpClientConfig, 'userAgent'>> & {\n    userAgent?: string;\n  };\n  private lastRateLimits?: RateLimits;\n\n  constructor(config: HttpClientConfig) {\n    this.config = {\n      apiToken: config.apiToken,\n      baseURL: config.baseURL || DEFAULT_BASE_URL,\n      timeout: config.timeout || DEFAULT_TIMEOUT,\n      retries: config.retries || DEFAULT_RETRIES,\n      retryDelay: config.retryDelay || DEFAULT_RETRY_DELAY,\n      retryableStatuses:\n        config.retryableStatuses || DEFAULT_RETRYABLE_STATUSES,\n      userAgent: config.userAgent,\n    };\n  }\n\n  /**\n   * Get the last rate limits from API response headers\n   */\n  getRateLimits(): RateLimits | undefined {\n    return this.lastRateLimits;\n  }\n\n  /**\n   * Make an HTTP request with retry logic\n   */\n  async request<T = any>(options: RequestOptions): Promise<T> {\n    const { method, path, body, headers, raw, signal } = options;\n\n    // Create abort controller for timeout\n    const controller = new AbortController();\n    const timeoutId = setTimeout(\n      () => controller.abort(),\n      this.config.timeout\n    );\n\n    // If external signal provided, listen to it\n    if (signal) {\n      signal.addEventListener('abort', () => controller.abort());\n    }\n\n    try {\n      return await withRetry(\n        async () => {\n          const url = `${this.config.baseURL}${path}`;\n\n          // Prepare headers\n          const requestHeaders: Record<string, string> = {\n            Authorization: `Bearer ${this.config.apiToken}`,\n            ...headers,\n          };\n\n          // Add user agent if provided\n          if (this.config.userAgent) {\n            requestHeaders['User-Agent'] = this.config.userAgent;\n          }\n\n          // Add content-type for JSON bodies\n          if (body && typeof body === 'string') {\n            requestHeaders['Content-Type'] = 'application/json';\n          }\n\n          // Make request\n          let response: Response;\n          try {\n            response = await fetch(url, {\n              method,\n              headers: requestHeaders,\n              body: body instanceof FormData || typeof body === 'string' ? body : undefined,\n              signal: controller.signal,\n            });\n          } catch (error: any) {\n            // Handle network errors\n            if (error.name === 'AbortError') {\n              throw new TimeoutError(\n                `Request timed out after ${this.config.timeout}ms`,\n                this.config.timeout\n              );\n            }\n            throw new NetworkError(\n              `Network request failed: ${error.message}`,\n              error\n            );\n          }\n\n          // Extract rate limits from headers\n          this.extractRateLimits(response.headers);\n\n          // Handle error responses\n          if (!response.ok) {\n            await this.handleErrorResponse(response);\n          }\n\n          // Return raw response if requested\n          if (raw) {\n            return response as any;\n          }\n\n          // Parse JSON response\n          const data = await response.json();\n\n          // Check for error in response body\n          if ((data as any).error) {\n            throw new ConversionToolsError(\n              (data as any).error,\n              'API_ERROR',\n              response.status,\n              data\n            );\n          }\n\n          return data as T;\n        },\n        {\n          retries: this.config.retries,\n          retryDelay: this.config.retryDelay,\n          retryableStatuses: this.config.retryableStatuses,\n        }\n      );\n    } finally {\n      clearTimeout(timeoutId);\n    }\n  }\n\n  /**\n   * Extract rate limits from response headers\n   */\n  private extractRateLimits(headers: Headers): void {\n    const limits: RateLimits = {};\n\n    const dailyLimit = headers.get('x-ratelimit-limit-tasks');\n    const dailyRemaining = headers.get('x-ratelimit-limit-tasks-remaining');\n    if (dailyLimit && dailyRemaining) {\n      limits.daily = {\n        limit: parseInt(dailyLimit, 10),\n        remaining: parseInt(dailyRemaining, 10),\n      };\n    }\n\n    const monthlyLimit = headers.get('x-ratelimit-limit-tasks-monthly');\n    const monthlyRemaining = headers.get(\n      'x-ratelimit-limit-tasks-monthly-remaining'\n    );\n    if (monthlyLimit && monthlyRemaining) {\n      limits.monthly = {\n        limit: parseInt(monthlyLimit, 10),\n        remaining: parseInt(monthlyRemaining, 10),\n      };\n    }\n\n    const fileSize = headers.get('x-ratelimit-limit-filesize');\n    if (fileSize) {\n      limits.fileSize = parseInt(fileSize, 10);\n    }\n\n    if (Object.keys(limits).length > 0) {\n      this.lastRateLimits = limits;\n    }\n  }\n\n  /**\n   * Handle error responses\n   */\n  private async handleErrorResponse(response: Response): Promise<never> {\n    const status = response.status;\n\n    // Try to parse error message from response\n    let errorMessage: string;\n    let errorData: any;\n\n    try {\n      errorData = await response.json();\n      errorMessage = errorData.error || response.statusText;\n    } catch {\n      errorMessage = response.statusText;\n    }\n\n    // Handle specific status codes\n    switch (status) {\n      case 401:\n        throw new AuthenticationError(errorMessage);\n\n      case 400:\n        throw new ValidationError(errorMessage, errorData);\n\n      case 404:\n        // Determine if it's a file or task not found\n        if (errorMessage.toLowerCase().includes('file')) {\n          throw new FileNotFoundError(errorMessage);\n        } else if (errorMessage.toLowerCase().includes('task')) {\n          throw new TaskNotFoundError(errorMessage);\n        }\n        throw new ConversionToolsError(errorMessage, 'NOT_FOUND', 404);\n\n      case 429:\n        throw new RateLimitError(\n          errorMessage ||\n            'Rate limit exceeded. Upgrade your plan at https://conversiontools.io/pricing',\n          this.lastRateLimits\n        );\n\n      case 408:\n        throw new TimeoutError(errorMessage);\n\n      default:\n        throw new ConversionToolsError(\n          errorMessage,\n          'HTTP_ERROR',\n          status,\n          errorData\n        );\n    }\n  }\n\n  /**\n   * Make a GET request\n   */\n  async get<T = any>(path: string, options?: Partial<RequestOptions>): Promise<T> {\n    return this.request<T>({\n      method: 'GET',\n      path,\n      ...options,\n    });\n  }\n\n  /**\n   * Make a POST request\n   */\n  async post<T = any>(\n    path: string,\n    body?: any,\n    options?: Partial<RequestOptions>\n  ): Promise<T> {\n    return this.request<T>({\n      method: 'POST',\n      path,\n      body,\n      ...options,\n    });\n  }\n}\n","/**\n * Input validation utilities\n */\n\nimport { ValidationError } from './errors.js';\nimport type { ConversionInput } from '../types/config.js';\n\n/**\n * Validate conversion type format\n */\nexport function validateConversionType(type: string): void {\n  if (!type || typeof type !== 'string') {\n    throw new ValidationError('Conversion type is required and must be a string');\n  }\n\n  // Check if it follows the pattern convert.source_to_target\n  if (!type.startsWith('convert.')) {\n    throw new ValidationError(\n      `Invalid conversion type format: \"${type}\". Expected format: \"convert.source_to_target\"`\n    );\n  }\n}\n\n/**\n * Validate and normalize conversion input\n */\nexport function validateConversionInput(input: ConversionInput): {\n  type: 'path' | 'url' | 'stream' | 'buffer' | 'fileId';\n  value: any;\n} {\n  if (!input) {\n    throw new ValidationError('Input is required');\n  }\n\n  // String input = file path\n  if (typeof input === 'string') {\n    return { type: 'path', value: input };\n  }\n\n  // Object input\n  if (typeof input === 'object' && input !== null) {\n    // Explicit path\n    if ('path' in input && typeof input.path === 'string') {\n      return { type: 'path', value: input.path };\n    }\n\n    // URL\n    if ('url' in input && typeof input.url === 'string') {\n      if (!isValidUrl(input.url)) {\n        throw new ValidationError(`Invalid URL: ${input.url}`);\n      }\n      return { type: 'url', value: input.url };\n    }\n\n    // Stream\n    if ('stream' in input && input.stream) {\n      return { type: 'stream', value: input.stream };\n    }\n\n    // Buffer\n    if ('buffer' in input && Buffer.isBuffer(input.buffer)) {\n      return { type: 'buffer', value: input };\n    }\n\n    // File ID\n    if ('fileId' in input && typeof input.fileId === 'string') {\n      return { type: 'fileId', value: input.fileId };\n    }\n  }\n\n  throw new ValidationError(\n    'Invalid input format. Expected: string, { path }, { url }, { stream }, { buffer }, or { fileId }'\n  );\n}\n\n/**\n * Validate URL format\n */\nfunction isValidUrl(url: string): boolean {\n  try {\n    new URL(url);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Validate API token\n */\nexport function validateApiToken(token: string): void {\n  if (!token || typeof token !== 'string') {\n    throw new ValidationError('API token is required and must be a string');\n  }\n\n  if (token.trim().length === 0) {\n    throw new ValidationError('API token cannot be empty');\n  }\n}\n\n/**\n * Validate file ID format\n */\nexport function validateFileId(fileId: string): void {\n  if (!fileId || typeof fileId !== 'string') {\n    throw new ValidationError('File ID is required and must be a string');\n  }\n\n  // File IDs are typically 32-character hex strings\n  if (!/^[a-f0-9]{32}$/i.test(fileId)) {\n    throw new ValidationError(\n      `Invalid file ID format: \"${fileId}\". Expected 32-character hexadecimal string`\n    );\n  }\n}\n\n/**\n * Validate task ID format\n */\nexport function validateTaskId(taskId: string): void {\n  if (!taskId || typeof taskId !== 'string') {\n    throw new ValidationError('Task ID is required and must be a string');\n  }\n\n  // Task IDs are typically 32-character hex strings\n  if (!/^[a-f0-9]{32}$/i.test(taskId)) {\n    throw new ValidationError(\n      `Invalid task ID format: \"${taskId}\". Expected 32-character hexadecimal string`\n    );\n  }\n}\n","/**\n * Progress tracking utilities\n */\n\nimport type { ProgressEvent } from '../types/config.js';\n\n/**\n * Create a progress event object\n */\nexport function createProgressEvent(\n  loaded: number,\n  total?: number\n): ProgressEvent {\n  const event: ProgressEvent = {\n    loaded,\n    total,\n  };\n\n  if (total && total > 0) {\n    event.percent = Math.round((loaded / total) * 100);\n  }\n\n  return event;\n}\n\n/**\n * Track upload progress from a stream\n */\nexport function trackStreamProgress(\n  stream: NodeJS.ReadableStream,\n  onProgress?: (progress: ProgressEvent) => void,\n  total?: number\n): NodeJS.ReadableStream {\n  if (!onProgress) {\n    return stream;\n  }\n\n  let loaded = 0;\n\n  stream.on('data', (chunk: Buffer) => {\n    loaded += chunk.length;\n    onProgress(createProgressEvent(loaded, total));\n  });\n\n  return stream;\n}\n\n/**\n * Calculate percentage\n */\nexport function calculatePercent(loaded: number, total: number): number {\n  if (total <= 0) return 0;\n  return Math.round((loaded / total) * 100);\n}\n","/**\n * Files API - Upload, download, and manage files\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Readable } from 'stream';\nimport type {\n  FileUploadResponse,\n  FileInfo,\n  FileUploadOptions,\n} from '../types/config.js';\nimport { HttpClient } from './http.js';\nimport { ValidationError } from '../utils/errors.js';\nimport { validateFileId } from '../utils/validation.js';\nimport { trackStreamProgress } from '../utils/progress.js';\n\nexport class FilesAPI {\n  constructor(private readonly http: HttpClient) {}\n\n  /**\n   * Upload a file from various sources\n   */\n  async upload(\n    input: string | NodeJS.ReadableStream | Buffer,\n    options?: FileUploadOptions\n  ): Promise<string> {\n    let stream: NodeJS.ReadableStream;\n    let filename: string | undefined;\n    let fileSize: number | undefined;\n\n    // Handle different input types\n    if (typeof input === 'string') {\n      // File path\n      if (!fs.existsSync(input)) {\n        throw new ValidationError(`File not found: ${input}`);\n      }\n      const stats = fs.statSync(input);\n      if (!stats.isFile()) {\n        throw new ValidationError(`Not a file: ${input}`);\n      }\n      stream = fs.createReadStream(input);\n      filename = path.basename(input);\n      fileSize = stats.size;\n    } else if (Buffer.isBuffer(input)) {\n      // Buffer\n      stream = Readable.from(input);\n      fileSize = input.length;\n    } else {\n      // Stream\n      stream = input;\n    }\n\n    // Track progress if callback provided\n    if (options?.onProgress) {\n      stream = trackStreamProgress(stream, options.onProgress, fileSize);\n    }\n\n    // Create FormData for upload\n    const formData = new FormData();\n\n    // Convert Node stream to Web ReadableStream for FormData\n    const chunks: Uint8Array[] = [];\n    for await (const chunk of stream) {\n      if (typeof chunk === 'string') {\n        chunks.push(new TextEncoder().encode(chunk));\n      } else if (chunk instanceof Buffer) {\n        chunks.push(new Uint8Array(chunk));\n      } else {\n        chunks.push(chunk);\n      }\n    }\n    const blob = new Blob(chunks);\n    formData.append('file', blob, filename || 'file');\n\n    // Upload file\n    const response = await this.http.post<FileUploadResponse>('/files', formData);\n\n    if (response.error) {\n      throw new ValidationError(response.error);\n    }\n\n    return response.file_id;\n  }\n\n  /**\n   * Get file metadata\n   */\n  async getInfo(fileId: string): Promise<FileInfo> {\n    validateFileId(fileId);\n    return this.http.get<FileInfo>(`/files/${encodeURIComponent(fileId)}/info`);\n  }\n\n  /**\n   * Download file as stream\n   */\n  async downloadStream(fileId: string): Promise<NodeJS.ReadableStream> {\n    validateFileId(fileId);\n\n    const response = await this.http.get<Response>(`/files/${encodeURIComponent(fileId)}`, {\n      raw: true,\n    });\n\n    if (!response.body) {\n      throw new ValidationError('No response body');\n    }\n\n    // Convert Web ReadableStream to Node.js ReadableStream\n    return Readable.fromWeb(response.body);\n  }\n\n  /**\n   * Download file as buffer\n   */\n  async downloadBuffer(fileId: string): Promise<Buffer> {\n    validateFileId(fileId);\n\n    const response = await this.http.get<Response>(`/files/${encodeURIComponent(fileId)}`, {\n      raw: true,\n    });\n\n    const arrayBuffer = await response.arrayBuffer();\n    return Buffer.from(arrayBuffer);\n  }\n\n  /**\n   * Download file to path\n   */\n  async downloadTo(fileId: string, outputPath?: string): Promise<string> {\n    validateFileId(fileId);\n\n    const response = await this.http.get<Response>(`/files/${encodeURIComponent(fileId)}`, {\n      raw: true,\n    });\n\n    // Determine output filename\n    let filename = outputPath;\n    if (!filename) {\n      // Try to get filename from Content-Disposition header\n      const disposition = response.headers.get('content-disposition');\n      if (disposition) {\n        const matches = /filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/.exec(\n          disposition\n        );\n        if (matches && matches[1]) {\n          filename = matches[1].replace(/['\"]/g, '');\n        }\n      }\n      filename = filename || 'result';\n    }\n\n    // Ensure directory exists\n    const dir = path.dirname(filename);\n    if (!fs.existsSync(dir)) {\n      fs.mkdirSync(dir, { recursive: true });\n    }\n\n    // Stream response to file\n    if (!response.body) {\n      throw new ValidationError('No response body');\n    }\n\n    const nodeStream = Readable.fromWeb(response.body);\n    const writeStream = fs.createWriteStream(filename);\n\n    await new Promise<void>((resolve, reject) => {\n      nodeStream.pipe(writeStream);\n      writeStream.on('finish', () => resolve());\n      writeStream.on('error', reject);\n      nodeStream.on('error', reject);\n    });\n\n    return filename;\n  }\n}\n","/**\n * Tasks API - Create and manage conversion tasks\n */\n\nimport type {\n  TaskCreateRequest,\n  TaskCreateResponse,\n  TaskStatusResponse,\n  TaskStatus,\n} from '../types/config.js';\nimport { HttpClient } from './http.js';\nimport { validateTaskId, validateConversionType } from '../utils/validation.js';\n\nexport interface TaskListOptions {\n  status?: TaskStatus;\n}\n\nexport interface TaskDetail {\n  id: string;\n  type: string;\n  status: TaskStatus;\n  error: string | null;\n  url: string | null;\n  dateCreated: string;\n  dateFinished: string | null;\n  conversionProgress: number;\n  fileSource?: {\n    id: string;\n    name: string;\n    size: number;\n    exists: boolean;\n  };\n  fileResult?: {\n    id: string;\n    name: string;\n    size: number;\n    exists: boolean;\n  };\n}\n\nexport class TasksAPI {\n  constructor(private readonly http: HttpClient) {}\n\n  /**\n   * Create a new conversion task\n   */\n  async create(request: TaskCreateRequest): Promise<TaskCreateResponse> {\n    validateConversionType(request.type);\n\n    const response = await this.http.post<TaskCreateResponse>(\n      '/tasks',\n      JSON.stringify(request)\n    );\n\n    if (response.error) {\n      throw new Error(response.error);\n    }\n\n    return response;\n  }\n\n  /**\n   * Get task status\n   */\n  async getStatus(taskId: string): Promise<TaskStatusResponse> {\n    validateTaskId(taskId);\n\n    const response = await this.http.get<TaskStatusResponse>(\n      `/tasks/${encodeURIComponent(taskId)}`\n    );\n\n    return response;\n  }\n\n  /**\n   * List all tasks (optionally filtered by status)\n   */\n  async list(options?: TaskListOptions): Promise<TaskDetail[]> {\n    let path = '/tasks';\n\n    if (options?.status) {\n      path += `?status=${encodeURIComponent(options.status)}`;\n    }\n\n    const response = await this.http.get<{ error: string | null; data: TaskDetail[] }>(\n      path\n    );\n\n    if (response.error) {\n      throw new Error(response.error);\n    }\n\n    return response.data;\n  }\n}\n","/**\n * Config API - Get API configuration and user info\n */\n\nimport type { UserInfo } from '../types/config.js';\nimport { HttpClient } from './http.js';\n\nexport interface ConversionConfig {\n  type: string;\n  title: string;\n  options: string[];\n}\n\nexport interface ApiConfig {\n  error: string | null;\n  conversions: ConversionConfig[];\n}\n\nexport class ConfigAPI {\n  constructor(private readonly http: HttpClient) {}\n\n  /**\n   * Get authenticated user info\n   */\n  async getUserInfo(): Promise<UserInfo> {\n    const response = await this.http.get<UserInfo>('/auth');\n\n    if (response.error) {\n      throw new Error(response.error);\n    }\n\n    return response;\n  }\n\n  /**\n   * Get API configuration (available conversion types)\n   */\n  async getConfig(): Promise<ApiConfig> {\n    const response = await this.http.get<ApiConfig>('/config');\n\n    if (response.error) {\n      throw new Error(response.error);\n    }\n\n    return response;\n  }\n}\n","/**\n * Smart polling utilities with exponential backoff\n */\n\nimport type { TaskStatusResponse } from '../types/config.js';\nimport { TimeoutError } from './errors.js';\n\nexport interface PollingOptions {\n  /** Initial polling interval in milliseconds */\n  interval: number;\n\n  /** Maximum polling interval in milliseconds */\n  maxInterval: number;\n\n  /** Backoff multiplier */\n  backoff: number;\n\n  /** Maximum wait time in milliseconds (0 = no limit) */\n  timeout?: number;\n\n  /** Progress callback */\n  onProgress?: (status: TaskStatusResponse) => void;\n}\n\n/**\n * Sleep for a given duration\n */\nfunction sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n/**\n * Poll a function until a condition is met\n */\nexport async function poll<T>(\n  fn: () => Promise<T>,\n  shouldContinue: (result: T) => boolean,\n  options: PollingOptions\n): Promise<T> {\n  const { interval, maxInterval, backoff, timeout, onProgress } = options;\n\n  const startTime = Date.now();\n  let currentInterval = interval;\n  let result: T;\n\n  while (true) {\n    // Execute the function\n    result = await fn();\n\n    // Check if we should stop polling\n    if (!shouldContinue(result)) {\n      return result;\n    }\n\n    // Check timeout\n    if (timeout && timeout > 0) {\n      const elapsed = Date.now() - startTime;\n      if (elapsed >= timeout) {\n        throw new TimeoutError(\n          `Polling timed out after ${timeout}ms`,\n          timeout\n        );\n      }\n    }\n\n    // Call progress callback\n    if (onProgress && typeof result === 'object' && result !== null) {\n      onProgress(result as any);\n    }\n\n    // Wait before next poll\n    await sleep(currentInterval);\n\n    // Increase interval with backoff (capped at maxInterval)\n    currentInterval = Math.min(currentInterval * backoff, maxInterval);\n  }\n}\n\n/**\n * Poll task status until completion\n */\nexport async function pollTaskStatus(\n  getStatus: () => Promise<TaskStatusResponse>,\n  options: PollingOptions\n): Promise<TaskStatusResponse> {\n  return poll(\n    getStatus,\n    (status) => {\n      // Continue polling if task is pending or running\n      return status.status === 'PENDING' || status.status === 'RUNNING';\n    },\n    options\n  );\n}\n","/**\n * Task model - High-level interface for conversion tasks\n */\n\nimport type {\n  TaskStatus,\n  TaskStatusResponse,\n  WaitOptions,\n} from '../types/config.js';\nimport { TasksAPI } from '../api/tasks.js';\nimport { FilesAPI } from '../api/files.js';\nimport { ConversionError } from '../utils/errors.js';\nimport { pollTaskStatus } from '../utils/polling.js';\n\nexport interface TaskOptions {\n  /** Task ID */\n  id: string;\n\n  /** Conversion type */\n  type: string;\n\n  /** Initial status (optional) */\n  status?: TaskStatus;\n\n  /** File ID (result file, if completed) */\n  fileId?: string | null;\n\n  /** Error message (if failed) */\n  error?: string | null;\n\n  /** Conversion progress (0-100) */\n  conversionProgress?: number;\n\n  /** Default polling configuration */\n  defaultPolling?: {\n    interval: number;\n    maxInterval: number;\n    backoff: number;\n  };\n}\n\nexport class Task {\n  readonly id: string;\n  readonly type: string;\n\n  private _status: TaskStatus;\n  private _fileId: string | null;\n  private _error: string | null;\n  private _conversionProgress: number;\n\n  private readonly tasksAPI: TasksAPI;\n  private readonly filesAPI: FilesAPI;\n  private readonly defaultPolling: {\n    interval: number;\n    maxInterval: number;\n    backoff: number;\n  };\n\n  constructor(\n    options: TaskOptions,\n    tasksAPI: TasksAPI,\n    filesAPI: FilesAPI\n  ) {\n    this.id = options.id;\n    this.type = options.type;\n    this._status = options.status || 'PENDING';\n    this._fileId = options.fileId || null;\n    this._error = options.error || null;\n    this._conversionProgress = options.conversionProgress || 0;\n    this.tasksAPI = tasksAPI;\n    this.filesAPI = filesAPI;\n    this.defaultPolling = options.defaultPolling || {\n      interval: 5000,\n      maxInterval: 30000,\n      backoff: 1.5,\n    };\n  }\n\n  /**\n   * Get current status\n   */\n  get status(): TaskStatus {\n    return this._status;\n  }\n\n  /**\n   * Get result file ID\n   */\n  get fileId(): string | null {\n    return this._fileId;\n  }\n\n  /**\n   * Get error message\n   */\n  get error(): string | null {\n    return this._error;\n  }\n\n  /**\n   * Get conversion progress (0-100)\n   */\n  get conversionProgress(): number {\n    return this._conversionProgress;\n  }\n\n  /**\n   * Check if task is complete (success or error)\n   */\n  get isComplete(): boolean {\n    return this._status === 'SUCCESS' || this._status === 'ERROR';\n  }\n\n  /**\n   * Check if task succeeded\n   */\n  get isSuccess(): boolean {\n    return this._status === 'SUCCESS';\n  }\n\n  /**\n   * Check if task failed\n   */\n  get isError(): boolean {\n    return this._status === 'ERROR';\n  }\n\n  /**\n   * Check if task is still running\n   */\n  get isRunning(): boolean {\n    return this._status === 'PENDING' || this._status === 'RUNNING';\n  }\n\n  /**\n   * Refresh task status from API\n   */\n  async refresh(): Promise<void> {\n    const response = await this.tasksAPI.getStatus(this.id);\n    this.updateFromResponse(response);\n  }\n\n  /**\n   * Get task status (alias for refresh)\n   */\n  async getStatus(): Promise<TaskStatusResponse> {\n    const response = await this.tasksAPI.getStatus(this.id);\n    this.updateFromResponse(response);\n    return response;\n  }\n\n  /**\n   * Wait for task to complete\n   */\n  async wait(options?: WaitOptions): Promise<void> {\n    // Use provided options or defaults\n    const pollingOptions = {\n      interval: options?.pollingInterval || this.defaultPolling.interval,\n      maxInterval:\n        options?.maxPollingInterval || this.defaultPolling.maxInterval,\n      backoff: this.defaultPolling.backoff,\n      timeout: options?.timeout,\n      onProgress: options?.onProgress,\n    };\n\n    // Poll until complete\n    const finalStatus = await pollTaskStatus(\n      () => this.getStatus(),\n      pollingOptions\n    );\n\n    // Update internal state\n    this.updateFromResponse(finalStatus);\n\n    // Throw error if task failed\n    if (this._status === 'ERROR') {\n      throw new ConversionError(\n        this._error || 'Conversion failed',\n        this.id,\n        this._error || undefined\n      );\n    }\n  }\n\n  /**\n   * Download result file as stream\n   */\n  async downloadStream(): Promise<NodeJS.ReadableStream> {\n    if (!this._fileId) {\n      throw new ConversionError(\n        'No result file available. Task may not be complete.',\n        this.id\n      );\n    }\n\n    return this.filesAPI.downloadStream(this._fileId);\n  }\n\n  /**\n   * Download result file as buffer\n   */\n  async downloadBuffer(): Promise<Buffer> {\n    if (!this._fileId) {\n      throw new ConversionError(\n        'No result file available. Task may not be complete.',\n        this.id\n      );\n    }\n\n    return this.filesAPI.downloadBuffer(this._fileId);\n  }\n\n  /**\n   * Download result file to path\n   */\n  async downloadTo(outputPath?: string): Promise<string> {\n    if (!this._fileId) {\n      throw new ConversionError(\n        'No result file available. Task may not be complete.',\n        this.id\n      );\n    }\n\n    return this.filesAPI.downloadTo(this._fileId, outputPath);\n  }\n\n  /**\n   * Update task state from API response\n   */\n  private updateFromResponse(response: TaskStatusResponse): void {\n    this._status = response.status;\n    this._fileId = response.file_id;\n    this._error = response.error;\n    this._conversionProgress = response.conversionProgress;\n  }\n\n  /**\n   * Convert to JSON\n   */\n  toJSON(): {\n    id: string;\n    type: string;\n    status: TaskStatus;\n    fileId: string | null;\n    error: string | null;\n    conversionProgress: number;\n    } {\n    return {\n      id: this.id,\n      type: this.type,\n      status: this._status,\n      fileId: this._fileId,\n      error: this._error,\n      conversionProgress: this._conversionProgress,\n    };\n  }\n}\n","/**\n * Main Conversion Tools API Client\n */\n\nimport type {\n  ConversionToolsConfig,\n  ConvertOptions,\n  ConversionType,\n  RateLimits,\n  UserInfo,\n} from './types/config.js';\nimport { HttpClient } from './api/http.js';\nimport { FilesAPI } from './api/files.js';\nimport { TasksAPI } from './api/tasks.js';\nimport { ConfigAPI } from './api/config.js';\nimport { Task } from './models/Task.js';\nimport { validateApiToken, validateConversionInput } from './utils/validation.js';\n\n// Package version (will be replaced during build)\nconst VERSION = '2.0.0';\n\nexport class ConversionToolsClient {\n  private readonly config: Required<\n    Omit<\n      ConversionToolsConfig,\n      'webhookUrl' | 'onUploadProgress' | 'onDownloadProgress' | 'onConversionProgress'\n    >\n  > & {\n    webhookUrl?: string;\n    onUploadProgress?: ConversionToolsConfig['onUploadProgress'];\n    onDownloadProgress?: ConversionToolsConfig['onDownloadProgress'];\n    onConversionProgress?: ConversionToolsConfig['onConversionProgress'];\n  };\n\n  private readonly http: HttpClient;\n\n  /** Files API */\n  public readonly files: FilesAPI;\n\n  /** Tasks API */\n  public readonly tasks: TasksAPI;\n\n  private readonly configAPI: ConfigAPI;\n\n  constructor(config: ConversionToolsConfig) {\n    // Validate API token\n    validateApiToken(config.apiToken);\n\n    // Set up configuration with defaults\n    this.config = {\n      apiToken: config.apiToken,\n      baseURL: config.baseURL || 'https://api.conversiontools.io/v1',\n      timeout: config.timeout || 300000,\n      retries: config.retries !== undefined ? config.retries : 3,\n      retryDelay: config.retryDelay || 1000,\n      retryableStatuses: config.retryableStatuses || [408, 500, 502, 503, 504],\n      pollingInterval: config.pollingInterval || 5000,\n      maxPollingInterval: config.maxPollingInterval || 30000,\n      pollingBackoff: config.pollingBackoff || 1.5,\n      webhookUrl: config.webhookUrl,\n      onUploadProgress: config.onUploadProgress,\n      onDownloadProgress: config.onDownloadProgress,\n      onConversionProgress: config.onConversionProgress,\n    };\n\n    // Initialize HTTP client\n    this.http = new HttpClient({\n      apiToken: this.config.apiToken,\n      baseURL: this.config.baseURL,\n      timeout: this.config.timeout,\n      retries: this.config.retries,\n      retryDelay: this.config.retryDelay,\n      retryableStatuses: this.config.retryableStatuses,\n      userAgent: `conversiontools-node/${VERSION}`,\n    });\n\n    // Initialize API clients\n    this.files = new FilesAPI(this.http);\n    this.tasks = new TasksAPI(this.http);\n    this.configAPI = new ConfigAPI(this.http);\n  }\n\n  /**\n   * Simple conversion method - upload, convert, wait, and download in one call\n   */\n  async convert<T extends ConversionType>(\n    options: ConvertOptions<T>\n  ): Promise<string> {\n    const {\n      type,\n      input,\n      output,\n      options: conversionOptions,\n      wait = true,\n      callbackUrl,\n      polling,\n    } = options;\n\n    // Validate and normalize input\n    const inputInfo = validateConversionInput(input);\n\n    let fileId: string | undefined;\n    let taskOptions: Record<string, any> = {\n      ...conversionOptions,\n    };\n\n    // Handle different input types\n    if (inputInfo.type === 'fileId') {\n      // Already uploaded file\n      fileId = inputInfo.value;\n      taskOptions.file_id = fileId;\n    } else if (inputInfo.type === 'url') {\n      // URL-based conversion\n      taskOptions.url = inputInfo.value;\n    } else {\n      // Upload file first\n      if (inputInfo.type === 'path') {\n        fileId = await this.files.upload(inputInfo.value, {\n          onProgress: this.config.onUploadProgress,\n        });\n      } else if (inputInfo.type === 'stream') {\n        fileId = await this.files.upload(inputInfo.value, {\n          onProgress: this.config.onUploadProgress,\n        });\n      } else if (inputInfo.type === 'buffer') {\n        fileId = await this.files.upload(inputInfo.value.buffer, {\n          onProgress: this.config.onUploadProgress,\n        });\n      }\n\n      if (fileId) {\n        taskOptions.file_id = fileId;\n      }\n    }\n\n    // Create task\n    const task = await this.createTask({\n      type: type as string,\n      options: taskOptions,\n      callbackUrl: callbackUrl || this.config.webhookUrl,\n    });\n\n    // If not waiting, return task ID\n    if (!wait) {\n      return task.id;\n    }\n\n    // Wait for completion with progress updates\n    await task.wait({\n      pollingInterval: polling?.interval || this.config.pollingInterval,\n      maxPollingInterval:\n        polling?.maxInterval || this.config.maxPollingInterval,\n      onProgress: (status) => {\n        if (this.config.onConversionProgress) {\n          this.config.onConversionProgress({\n            loaded: status.conversionProgress,\n            total: 100,\n            percent: status.conversionProgress,\n            status: status.status,\n            taskId: task.id,\n          });\n        }\n      },\n    });\n\n    // Download result\n    const outputPath = await task.downloadTo(output);\n\n    return outputPath;\n  }\n\n  /**\n   * Create a conversion task (low-level API)\n   */\n  async createTask(request: {\n    type: string;\n    options: Record<string, any>;\n    callbackUrl?: string;\n  }): Promise<Task> {\n    const response = await this.tasks.create(request);\n\n    return new Task(\n      {\n        id: response.task_id,\n        type: String(request.type),\n        status: 'PENDING',\n        defaultPolling: {\n          interval: this.config.pollingInterval,\n          maxInterval: this.config.maxPollingInterval,\n          backoff: this.config.pollingBackoff,\n        },\n      },\n      this.tasks,\n      this.files\n    );\n  }\n\n  /**\n   * Get an existing task by ID\n   */\n  async getTask(taskId: string): Promise<Task> {\n    const response = await this.tasks.getStatus(taskId);\n\n    return new Task(\n      {\n        id: taskId,\n        type: '', // Type not available from status response\n        status: response.status,\n        fileId: response.file_id,\n        error: response.error,\n        conversionProgress: response.conversionProgress,\n        defaultPolling: {\n          interval: this.config.pollingInterval,\n          maxInterval: this.config.maxPollingInterval,\n          backoff: this.config.pollingBackoff,\n        },\n      },\n      this.tasks,\n      this.files\n    );\n  }\n\n  /**\n   * Get rate limits from last API call\n   */\n  getRateLimits(): RateLimits | undefined {\n    return this.http.getRateLimits();\n  }\n\n  /**\n   * Get authenticated user information\n   */\n  async getUser(): Promise<UserInfo> {\n    return this.configAPI.getUserInfo();\n  }\n\n  /**\n   * Get API configuration (available conversion types)\n   */\n  async getConfig() {\n    return this.configAPI.getConfig();\n  }\n}\n","/**\n * Legacy v1 API compatibility layer\n *\n * @deprecated This is the v1 API which is deprecated. Please migrate to v2.\n * See migration guide: https://conversiontools.io/api-documentation#upgrade-v1-to-v2\n *\n * @example\n * ```javascript\n * // OLD v1 API (deprecated)\n * const ConversionClient = require('conversiontools/legacy');\n * const client = new ConversionClient(apiToken);\n *\n * await client.run('convert.xml_to_csv', {\n *   filename: 'data.xml',\n *   outputFilename: 'result.csv',\n *   timeout: 5000,\n *   options: { delimiter: 'tab' }\n * });\n *\n * // NEW v2 API (recommended)\n * const { ConversionToolsClient } = require('conversiontools');\n * const client = new ConversionToolsClient({ apiToken });\n *\n * await client.convert({\n *   type: 'convert.xml_to_csv',\n *   input: 'data.xml',\n *   output: 'result.csv',\n *   options: { delimiter: 'tabulation' }\n * });\n * ```\n */\n\nimport { ConversionToolsClient } from '../client.js';\n\n// Show deprecation warning once\nlet warningShown = false;\n\nfunction showDeprecationWarning(): void {\n  if (warningShown) return;\n  warningShown = true;\n\n  console.error(\n    '\\n' +\n      '\\n' +\n      '   DEPRECATION WARNING: v1 API is deprecated                        \\n' +\n      '                                                                     \\n' +\n      ' You are using the legacy v1-compatible API from:                    \\n' +\n      '   require(\"conversiontools/legacy\")                                 \\n' +\n      '                                                                     \\n' +\n      ' Please migrate to v2 for improved features and better performance:  \\n' +\n      '   const { ConversionToolsClient } = require(\"conversiontools\");     \\n' +\n      '   const client = new ConversionToolsClient({ apiToken });           \\n' +\n      '                                                                     \\n' +\n      ' Migration guide:                                                    \\n' +\n      ' https://conversiontools.io/api-documentation#upgrade-v1-to-v2       \\n' +\n      '\\n'\n  );\n}\n\n/**\n * Legacy v1 API options\n */\ninterface V1ConversionOptions {\n  /** Input file path */\n  filename?: string;\n\n  /** Input URL */\n  url?: string;\n\n  /** Output file path */\n  outputFilename?: string;\n\n  /** Polling timeout in milliseconds */\n  timeout?: number;\n\n  /** Conversion-specific options */\n  options?: Record<string, any>;\n}\n\n/**\n * Legacy ConversionClient class (v1 API)\n *\n * @deprecated Use ConversionToolsClient from 'conversiontools' instead\n */\nexport default class ConversionClient {\n  private readonly client: ConversionToolsClient;\n\n  constructor(apiToken: string) {\n    showDeprecationWarning();\n\n    // Initialize v2 client\n    this.client = new ConversionToolsClient({\n      apiToken,\n    });\n  }\n\n  /**\n   * Run a conversion (v1 API method)\n   *\n   * @deprecated Use client.convert() instead\n   */\n  async run(\n    conversionType: string,\n    options: V1ConversionOptions\n  ): Promise<string> {\n    const { filename, url, outputFilename, timeout, options: conversionOptions } =\n      options;\n\n    // Determine input\n    let input: any;\n    if (filename) {\n      input = filename;\n    } else if (url) {\n      input = { url };\n    } else {\n      throw new Error('Either filename or url must be provided');\n    }\n\n    // Translate v1 options to v2\n    // Note: v1 used string values for some options (e.g., delimiter: 'tab')\n    // v2 uses more explicit values (e.g., delimiter: 'tabulation')\n    const translatedOptions = this.translateOptions(conversionOptions || {});\n\n    // Convert using v2 API\n    return this.client.convert({\n      type: conversionType,\n      input,\n      output: outputFilename,\n      options: translatedOptions,\n      polling: timeout\n        ? {\n          interval: timeout,\n        }\n        : undefined,\n    });\n  }\n\n  /**\n   * Translate v1 option values to v2\n   */\n  private translateOptions(options: Record<string, any>): Record<string, any> {\n    const translated = { ...options };\n\n    // Translate delimiter values\n    if (translated.delimiter) {\n      const delimiterMap: Record<string, string> = {\n        tab: 'tabulation',\n        comma: 'comma',\n        semicolon: 'semicolon',\n        pipe: 'vertical_bar',\n        vertical_bar: 'vertical_bar',\n      };\n      if (delimiterMap[translated.delimiter]) {\n        translated.delimiter = delimiterMap[translated.delimiter];\n      }\n    }\n\n    // Translate yes/no to boolean\n    ['images', 'javascript', 'background'].forEach((key) => {\n      if (translated[key] === 'yes') {\n        translated[key] = true;\n      } else if (translated[key] === 'no') {\n        translated[key] = false;\n      }\n    });\n\n    return translated;\n  }\n\n  /**\n   * Check task status (v1 internal method)\n   *\n   * @deprecated Not exposed in v1 API, use v2 API instead\n   */\n  async checkStatus(\n    taskId: string,\n    options: { filename?: string; timeout?: number }\n  ): Promise<string> {\n    const task = await this.client.getTask(taskId);\n\n    if (task.isRunning) {\n      // Wait with polling\n      await task.wait({\n        pollingInterval: options.timeout || 5000,\n      });\n    }\n\n    if (task.isError) {\n      throw new Error(task.error || 'Conversion failed');\n    }\n\n    // Download result\n    return task.downloadTo(options.filename);\n  }\n\n}\n\n// Note: Only using default export to avoid mixed export warnings\n// For CommonJS compatibility, use: const ConversionClient = require('conversiontools/legacy');\n// For ESM compatibility, use: import ConversionClient from 'conversiontools/legacy';\n"]}